{% extends "main/list_view.html" %}
{% load widget_tweaks %}
{% load static %}
{% load humanize %}
{% block head %}
  {% comment %} <script type="text/javascript" src="{% static '/main/js/jquery.tablesorter.js' %}"></script> {% endcomment %}
  <link rel="stylesheet" href="{% static "reference/css/table.css" %}">

{% endblock head %}

{% block title %}References{% endblock title%}
{% block heading %}References{% endblock heading %}

{% block test %}
<p class='text-center'>
Heatflow.org currently contains data from {{ count|intcomma }} publications spanning {{ num_years }} years of heat flow measurements around the globe! Search here to find a particular reference and access the related data. If you can't find what you're looking for but know it exists, why not <a href={% url 'main:upload' %}>upload</a> the data and help keep the largest heat flow database in the world up to date! 
</p>

<div class="d-flex align-bottom justify-content-center">

  {% comment %} <div>
      <a class="page-link" href="#" tabindex="-1" aria-disabled="true">
        <i class="fas fa-filter"></i>
      </a> 
  </div> {% endcomment %}
  {% include "main/paginator.html" %}  
</div>

{% endblock test %}



{% comment %} {% block filter %} {% endcomment %}
  {% comment %} <div class="card card-spacing filter-card">
    <div class="card-body">
      <h5 class="card-title text-center">Filter</h5>
      <form action="" method='GET'>
        <table>
          <tbody>
            <tr>
              <td>
                {% render_field filter.form.last_name class='form-control' placeholder='Last name' %}
              </td>
            </tr>
            <tr>
              <td>
                <div class='input-group'>
                  {% render_field filter.form.year_min class='form-control' placeholder='Year from' %}
                  &nbsp;
                  {% render_field filter.form.year_max class='form-control' placeholder='Year to' %}
                  &nbsp;
                  <button type='submit' class='btn btn-primary'>Update</button> 
                </div>
              </td>
            </tr>
          </tbody>
        </table>  
      </form>
    </div>
  </div>
  <br> {% endcomment %}
{% comment %} {% endblock filter %} {% endcomment %}

{% block list %}
  <div class='table-responsive'>
    <table id='detailsTable' class="table table-hover table-striped text-center">
      <thead class="thead-dark">
        {% comment %} <tr>
          <th class='text-left'></th>
          <th></th> 
          <th></th>
          <th>Heat Flow<br>Count</th>
          <th>Thermal<br>Conductivity<br>Count</th>
          <th>Heat<br>Generation<br>Count</th>
          <th>Temperature<br>Count</th>
        </tr> {% endcomment %}
        <tr>
          <th class='text-left'>Author[s]</th>
          <th>Year</th> 
          <th>Sites</th>
          <th>Heat Flow<br>Count</th>
          <th>Thermal<br>Conductivity<br>Count</th>
          <th>Heat<br>Generation<br>Count</th>
          <th>Temperature<br>Count</th>
          <th>Added</th>
        </tr>
      </thead>   
      <tbody>
        {% for ref in result %}
          <tr>
            <td class="text-left">
              <a href="{% url 'reference:reference_details' pk=ref.id %}">
              {% if ref.co_authors.count == 0 %}
                {{ ref.first_author.last_name }}
              {% elif ref.co_authors.count == 1 %}
                {{ ref.first_author.last_name }} &amp;        
                {{ ref.co_authors.all.0.last_name }}
              {% else %}
                {{ ref.first_author.last_name }} et al.
              {% endif %}
             </a>
            </td>
            <td>{{ ref.year|default_if_none:'Unknown' }}</td>
            <td>{{ ref.site_set.count }}</td>
            <td>{{ ref.depthinterval_set.count }}</td>
            <td>{{ ref.conductivity_set.count }}</td>
            <td>{{ ref.heatgeneration_set.count }}</td>
            <td>{{ ref.temperature_set.count }}</td>
            <td><p class='small'>
            {{ref.date_added|date:"M j, Y"}}
            </p></td>
          </tr>
        {% endfor %}
      </tbody>
    </table>
  </div>

<div class="d-flex align-bottom justify-content-center">
  {% include "main/paginator.html" %}  
</div>
 

{% endblock list%}





{% block more-scripts %}

  <script>
  $(document).ready(function(){
    $(function() {
      $("#detailsTable").tablesorter();
    });
  });
  </script>
{% endblock more-scripts %}